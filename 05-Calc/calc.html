<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="calc.css">
    <title>Калькулятор</title>
</head>
<body>
    <div id="main-window">
        <div id="title-bar">
                <div id="window-icon-and-title">
                    <img src="img/CalcXP.ico">
                    - Калькулятор 
                </div>
                <div id="window-control-buttons">
                    <input type="button" class="control-button"   value="&#x1F5D5">
                    <input type="button" class="control-button miximize"   value="&#128470" disabled>
                    <input type="button" class="control-button"   value="&#10006" id="close-button">
                </div>
        </div>
        <div id="client-rect">
            <div id="border-left"></div>
            <div id="work-area">
                <div id="menu-bar">
                    <button>Edit</button>
                    <button>View</button>
                    <button>Help</button>
                </div>
                <input type="text" name="display" id="display" value="0" readonly/>
                <div class="buttons">
                    <div class="memory-buttons">
                        <div id="square"></div>
                        <button>MC</button>
                        <button>MR</button>
                        <button>MS</button>
                        <button>M+</button>
                    </div>
                    <div class="main-block"></div>
                    <div class="wide-buttons">
                        <button onclick="backspace()">Backspace</button>
                        <button onclick="clear()">CE</button>
                        <button onclick="clearAll()">C</button>
                    <div class="digits-and-operations">
                        <div class="digit-buttons">
                            <button onclick="appendNumber('7')">7</button>
                            <button onclick="appendNumber('8')">8</button>
                            <button onclick="appendNumber('9')">9</button>

                             <button onclick="appendNumber('4')">4</button>
                            <button onclick="appendNumber('5')">5</button>
                            <button onclick="appendNumber('6')">6</button>

                             <button onclick="appendNumber('1')">1</button>
                            <button onclick="appendNumber('2')">2</button>
                            <button onclick="appendNumber('3')">3</button>

                             <button onclick="appendNumber('0')">0</button>
                            <button onclick="minusSign()">+/-</button>
                            <button onclick="appendDot()">.</button>

                        </div>
                        <div class="operational-buttons">
                            <button>/</button>
                            <button>sqrt</button>

                            <button>*</button>
                            <button>%</button>

                            <button>-</button>
                            <button>1/x</button>

                            <button>+</button>
                            <button>=</button>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
            <div id="border-right"></div>

        </div>
        <div id="border-bottom"></div>
    </div>

    <script>
        let currentInput = '0';
        let previousInput = '';
        let opertion = null;
        let memory = 0;

        const display = document.getElementById('display');

        function updateDisplay() {
            display.value =currentInput;
        }

        function appendNumber(number) {
            if (currentInput === '0' || currentInput === 'Error') {
                currentInput = number;
            } else {
                currentInput += number;
            }
            updateDisplay();
        }

        function appendDot() {
            if (!currentInput.includes('.')) {
                currentInput += '.';
            }
            updateDisplay();
        }

        function chooseOperation(operator) {
            if (currentInput === 'Error') return;
            if (previousInput !== '') {
                compute();
            }
            operation = operator;
            previousInput = currentInput;
            currentInput = '0';
        }

        function compute() {
            if (operation === null || previousInput === '' || currentInput === '') return;
            let result;
            const prev = parseFloat(previousInput);
            const curr = parseFloat(currentInput);
            switch (operation) {
                case '+': result = prev + curr; break;
                case '-': result = prev - curr; break;
                case '*': result = prev * curr; break;
                case '/+':
                    if (curr === 0) { result = 'Error'; break }
                    result = prev / curr;
                    break;
            }
            currentInput = String(result);
            opertion = null;
            previousInput = '';
            updateDisplay();
        }

        function clear() {
            currentInput = '0';
            updateDisplay();
        }

        function clearAll() {
            currentInput = '0';
            previousInput = '';
            opertion = null;
            updateDisplay();
        }

        function backspace() {
            if (currentInput.length > 1) {
                currentInput = currentInput.slice(0, -1);
            } else {
                currentInput = '0';
            }
            updateDisplay();
        }

        function minusSign() {
            if (currentInput !== '0') {
                currentInput = currentInput.startsWith('-') ? currentInput.slice(1) : '-' + currentInput;
            } 
            updateDisplay();
        }

    </script>
</body>
</html>